---
# =============================================================================
# HOST DEFINITIONS - All hosts with their IP addresses and basic attributes
# =============================================================================
all:
  hosts:
    # Localhost
    localhost:
      ansible_connection: local

    # Proxmox hosts
    prox0:
      ansible_host: 192.168.86.4
      desired_host: 192.168.86.4
    prox1:
      ansible_host: 192.168.86.6
      desired_host: 192.168.86.6

    # Raspberry Pi cluster
    k0:
      ansible_host: 192.168.86.20
      desired_host: 192.168.86.20
    k1:
      ansible_host: 192.168.86.21
      desired_host: 192.168.86.21
    k2:
      ansible_host: 192.168.86.22
      desired_host: 192.168.86.22
    k3:
      ansible_host: 192.168.86.23
      desired_host: 192.168.86.23
    k4:
      ansible_host: 192.168.86.24
      desired_host: 192.168.86.24
    k5:
      ansible_host: 192.168.86.25
      desired_host: 192.168.86.25

    # NUC hosts
    n0:
      ansible_host: 192.168.86.26
      desired_host: 192.168.86.26
    n1:
      ansible_host: 192.168.86.27
      desired_host: 192.168.86.27
    n2:
      ansible_host: 192.168.86.28
      desired_host: 192.168.86.28

    # VM hosts
    joi:
      ansible_host: 192.168.86.5
      desired_host: 192.168.86.5

  # Global variables
  vars:
    ip_base: "192.168.86"
    routers:
      - "{{ ip_base }}.1"
    ansible_connection: ssh
    ansible_python_interpreter: /usr/bin/python3
    ansible_ssh_private_key_file: ~/.ssh/id_ed25519

# =============================================================================
# HOST-SPECIFIC VARIABLES
# =============================================================================
# Proxmox host variables
prox1:
  vars:
    iommu:
      passthrough_enabled: true

# NUC host variables
n1:
  vars:
    iommu:
      enabled: true
    coral:
      enabled: true

# =============================================================================
# GROUP DEFINITIONS - Logical groupings of hosts
# =============================================================================
# Infrastructure groups
proxmox:
  hosts:
    prox0: {}
    prox1: {}
  vars:
    ansible_user: root
    ansible_ssh_user: root

pi:
  hosts:
    k0: {}
    k1: {}
    k2: {}
    k3: {}
    k4: {}
    k5: {}
  vars:
    ansible_user: pi
    ansible_ssh_user: pi

nuc:
  hosts:
    n0: {}
    n1: {}
    n2: {}

vm:
  hosts:
    joi: {}
    n0: {}
    n1: {}
    n2: {}
  vars:
    ansible_user: michael
    ansible_ssh_user: michael

# Hardware-specific groups
# nuc_host:
#   hosts:
#     prox1: {}

# nuc_i440:
#   hosts:

nuc_q35:
  hosts:
    n0: {}
    n1: {}
    n2: {}

# Kubernetes groups
k8s:
  children:
    pi: {}
    vm: {}
  vars:
    kubernetes_apiserver_advertise_address: "{{ ip_base }}.100"
    k0s_version: v1.27.5+k0s.0

# K8s node function groups
initial_controller:
  hosts:
    k0: {}
  vars:
    artifacts_dir: ~/.kube/
    extra_args: "--enable-worker --enable-dynamic-config --no-taints"

controller:
  hosts:
    k1: {}
    k2: {}
  vars:
    extra_args: "--enable-worker --enable-dynamic-config --no-taints"

worker:
  hosts:
    k3: {}
    k4: {}
    k5: {}
    joi: {}
    n0: {}
    n1: {}
    n2: {}

# Storage groups
longhorn:
  hosts:
    n0: {}
    n1: {}
    n2: {}
    joi: {}